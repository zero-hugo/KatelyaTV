# Cloudflare Pages éƒ¨ç½²æœ€åä¸€æ­¥ï¼šé…ç½® D1 æ•°æ®åº“ç»‘å®š

## ğŸ‰ å¥½æ¶ˆæ¯ï¼šæ„å»ºå®Œå…¨æˆåŠŸï¼

ä»éƒ¨ç½²æ—¥å¿—å¯ä»¥ç¡®è®¤ï¼š

- âœ… wrangler.toml é…ç½®é—®é¢˜å·²è§£å†³
- âœ… Next.js æ„å»ºæˆåŠŸï¼ˆæ— é”™è¯¯ï¼‰
- âœ… æ‰€æœ‰ API è·¯ç”±æ­£ç¡®è½¬æ¢ä¸º Edge Functions
- âœ… æ–‡ä»¶ä¸Šä¼ æˆåŠŸ

## ğŸ”§ æœ€åä¸€æ­¥ï¼šé…ç½®çœŸå®çš„ D1 æ•°æ®åº“ ID

### é—®é¢˜

```
Error 8000022: Invalid database UUID (your-d1-database-id-here)
```

### è§£å†³æ–¹æ¡ˆ

**æ–¹æ³• 1ï¼šåœ¨ wrangler.toml ä¸­é…ç½®ï¼ˆæ¨èï¼‰**

1. è·å–ä½ çš„ D1 æ•°æ®åº“ IDï¼š

   - ç™»å½• Cloudflare Dashboard
   - è¿›å…¥ **D1** éƒ¨åˆ†
   - æ‰¾åˆ°ä½ çš„æ•°æ®åº“
   - å¤åˆ¶ **Database ID**ï¼ˆç±»ä¼¼ï¼š`a1b2c3d4-e5f6-7890-abcd-ef1234567890`ï¼‰

2. æ›´æ–° `wrangler.toml` æ–‡ä»¶ç¬¬ 47 è¡Œï¼š
   ```toml
   [[env.production.d1_databases]]
   binding = "DB"
   database_name = "katelyatv-db"  # è¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰
   database_id = "ä½ çš„çœŸå®æ•°æ®åº“ID"  # æ›¿æ¢è¿™é‡Œ
   ```

**æ–¹æ³• 2ï¼šåœ¨ Cloudflare Pages æ§åˆ¶å°ä¸­é…ç½®**

1. è¿›å…¥ Cloudflare Pages â†’ ä½ çš„é¡¹ç›® â†’ Settings â†’ Functions
2. æ‰¾åˆ° **D1 database bindings** éƒ¨åˆ†
3. æ·»åŠ ç»‘å®šï¼š
   - **Variable name**: `DB`
   - **D1 database**: é€‰æ‹©ä½ çš„æ•°æ®åº“

### å®Œæˆå

1. **å¦‚æœä¿®æ”¹äº† wrangler.toml**ï¼š

   ```bash
   git add wrangler.toml
   git commit -m "fix: Update D1 database ID for production deployment"
   git push
   ```

2. **Cloudflare Pages ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²**

3. **éªŒè¯éƒ¨ç½²æˆåŠŸ**ï¼š
   - è®¿é—®ä½ çš„ç½‘ç«™
   - æ£€æŸ¥ `/admin` é¡µé¢æ˜¯å¦æ­£å¸¸
   - æµ‹è¯•æˆäººå†…å®¹è¿‡æ»¤åŠŸèƒ½

## ğŸ¯ é¢„æœŸç»“æœ

ä¿®å¤åï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

- âœ… Cloudflare Pages éƒ¨ç½²æˆåŠŸ
- âœ… `/admin` é¡µé¢æ­£å¸¸åŠ è½½ï¼ˆä¸å†æ˜¾ç¤º"è·å–é…ç½®å¤±è´¥"ï¼‰
- âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼ŒåŒ…æ‹¬æˆäººå†…å®¹è¿‡æ»¤
- âœ… D1 æ•°æ®åº“æ­£ç¡®è¿æ¥

## ğŸ“ æé†’

- æ•°æ®åº“ ID æ˜¯å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå¿…é¡»å‡†ç¡®
- ä¸è¦æŠŠæ•°æ®åº“ ID å’Œæ•°æ®åº“åç§°ææ··äº†
- å¦‚æœæ‰¾ä¸åˆ°æ•°æ®åº“ IDï¼Œå¯ä»¥åœ¨ Cloudflare D1 æ§åˆ¶å°ä¸­æŸ¥çœ‹æ•°æ®åº“è¯¦æƒ…

ä½ ç°åœ¨è·ç¦»å®Œå…¨æˆåŠŸåªå·®è¿™ä¸€æ­¥äº†ï¼ğŸš€
